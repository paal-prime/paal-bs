#include <gtest/gtest.h>
#include <utility>
#include <string>
#include <fstream>
#include <vector>
#include "../SteinerForest.h"
#include "../../graph/AdjacencyMatrix.h"
#include "../../graph/AdjacencyLists.h"

#include <iostream>

class SteinerTest : public ::testing::TestWithParam< std::pair<std::string, std::string> >
{

};

TEST_P(SteinerTest, asdf)
{
    std::pair< std::string, std::string> data = GetParam();
    std::ifstream graphData (data.first.c_str());

    size_t verticesCount, edgeCount;
    graphData >> verticesCount >> edgeCount;

    std::cout << verticesCount;

    AdjacencyLists<Graph::undirected, double> graph(verticesCount);

    int sets[verticesCount];
    for(int i = 0; i < verticesCount; ++i)
    {
        graphData >> sets[i];
    }

    for(int i = 0; i < edgeCount; ++i)
    {
        size_t a, b;
        double w;
        graphData >> a >> b >> w;
        graph.add_edge(a, b, w);
    }
    graphData.close();

    std::ifstream solutionData (data.second);
    double bestKnownSolution;
    solutionData >> bestKnownSolution;
    solutionData.close();
    std::vector< std::pair< std::pair<size_t, size_t>, double > > steiner_forest_edges;

    SteinerForest<>(graph, sets, std::back_inserter(steiner_forest_edges));

    double solutionCost = 0.0;
    std::cout << "OUTPUT" << std::endl;
    for(size_t i = 0; i < steiner_forest_edges.size(); ++i)
    {
        std::cout << steiner_forest_edges[i].first.first << " " << steiner_forest_edges[i].first.second << std::endl;
        std::cout << steiner_forest_edges[i].second << std::endl;
        solutionCost += steiner_forest_edges[i].second;
    }

    std::cout << "COST: " << solutionCost << std::endl;
    ASSERT_LE(solutionCost, 2 * bestKnownSolution);
    ASSERT_GE(solutionCost, bestKnownSolution);

}

INSTANTIATE_TEST_CASE_P(SteinerForest, SteinerTest,
                        ::testing::Values(
                                          make_pair(std::string("forest_test/vazirani0.in"),
                                                    std::string("forest_test/vazirani0.out")),
                                          make_pair(std::string("forest_test/vazirani1.in"),
                                                    std::string("forest_test/vazirani1.out")),
                                          make_pair(std::string("forest_test/handcrafted0.in"),
                                                    std::string("forest_test/handcrafted0.out")),
                                          make_pair(std::string("forest_test/handcrafted1.in"),
                                                    std::string("forest_test/handcrafted1.out")),
                                          make_pair(std::string("tree_test/b01.in"),
                                                    std::string("tree_test/b01.out")),
                                          make_pair(std::string("tree_test/b02.in"),
                                                    std::string("tree_test/b02.out")),
                                          make_pair(std::string("tree_test/b03.in"),
                                                    std::string("tree_test/b03.out")),
                                          make_pair(std::string("tree_test/b04.in"),
                                                    std::string("tree_test/b04.out")),
                                          make_pair(std::string("tree_test/b05.in"),
                                                    std::string("tree_test/b05.out")),
                                          make_pair(std::string("tree_test/b06.in"),
                                                    std::string("tree_test/b06.out")),
                                          make_pair(std::string("tree_test/b07.in"),
                                                    std::string("tree_test/b07.out")),
                                          make_pair(std::string("tree_test/b08.in"),
                                                    std::string("tree_test/b08.out")),
                                          make_pair(std::string("tree_test/b09.in"),
                                                    std::string("tree_test/b09.out")),
                                          make_pair(std::string("tree_test/b10.in"),
                                                    std::string("tree_test/b10.out")),
                                          make_pair(std::string("tree_test/b11.in"),
                                                    std::string("tree_test/b11.out")),
                                          make_pair(std::string("tree_test/b12.in"),
                                                    std::string("tree_test/b12.out")),
                                          make_pair(std::string("tree_test/b13.in"),
                                                    std::string("tree_test/b13.out")),
                                          make_pair(std::string("tree_test/b14.in"),
                                                    std::string("tree_test/b14.out")),
                                          make_pair(std::string("tree_test/b15.in"),
                                                    std::string("tree_test/b15.out")),
                                          make_pair(std::string("tree_test/b16.in"),
                                                    std::string("tree_test/b16.out")),
                                          make_pair(std::string("tree_test/b17.in"),
                                                    std::string("tree_test/b17.out")),
                                          make_pair(std::string("tree_test/b18.in"),
                                                    std::string("tree_test/b18.out")),
                                          make_pair(std::string("tree_test/c01.in"),
                                                    std::string("tree_test/c01.out")),
                                          make_pair(std::string("tree_test/c02.in"),
                                                    std::string("tree_test/c02.out")),
                                          make_pair(std::string("tree_test/c03.in"),
                                                    std::string("tree_test/c03.out")),
                                          make_pair(std::string("tree_test/c04.in"),
                                                    std::string("tree_test/c04.out")),
                                          make_pair(std::string("tree_test/c05.in"),
                                                    std::string("tree_test/c05.out")),
                                          make_pair(std::string("tree_test/c06.in"),
                                                    std::string("tree_test/c06.out")),
                                          make_pair(std::string("tree_test/c07.in"),
                                                    std::string("tree_test/c07.out")),
                                          make_pair(std::string("tree_test/c08.in"),
                                                    std::string("tree_test/c08.out")),
                                          make_pair(std::string("tree_test/c09.in"),
                                                    std::string("tree_test/c09.out")),
                                          make_pair(std::string("tree_test/c10.in"),
                                                    std::string("tree_test/c10.out")),
                                          make_pair(std::string("tree_test/c11.in"),
                                                    std::string("tree_test/c11.out")),
                                          make_pair(std::string("tree_test/c12.in"),
                                                    std::string("tree_test/c12.out")),
                                          make_pair(std::string("tree_test/c13.in"),
                                                    std::string("tree_test/c13.out")),
                                          make_pair(std::string("tree_test/c14.in"),
                                                    std::string("tree_test/c14.out")),
                                          make_pair(std::string("tree_test/c15.in"),
                                                    std::string("tree_test/c15.out")),
                                          make_pair(std::string("tree_test/c16.in"),
                                                    std::string("tree_test/c16.out")),
                                          make_pair(std::string("tree_test/c17.in"),
                                                    std::string("tree_test/c17.out")),
                                          make_pair(std::string("tree_test/c18.in"),
                                                    std::string("tree_test/c18.out")),
                                          make_pair(std::string("tree_test/c19.in"),
                                                    std::string("tree_test/c19.out")),
                                          make_pair(std::string("tree_test/c20.in"),
                                                    std::string("tree_test/c20.out"))
                                          )
                       );

INSTANTIATE_TEST_CASE_P(SteinerForest2, SteinerTest,
                        ::testing::Values(
                                          make_pair(std::string("tree_test/d01.in"),
                                                    std::string("tree_test/d01.out")),
                                          make_pair(std::string("tree_test/d02.in"),
                                                    std::string("tree_test/d02.out")),
                                          make_pair(std::string("tree_test/d03.in"),
                                                    std::string("tree_test/d03.out")),
                                          make_pair(std::string("tree_test/d04.in"),
                                                    std::string("tree_test/d04.out")),
                                          make_pair(std::string("tree_test/d05.in"),
                                                    std::string("tree_test/d05.out")),
                                          make_pair(std::string("tree_test/d06.in"),
                                                    std::string("tree_test/d06.out")),
                                          make_pair(std::string("tree_test/d07.in"),
                                                    std::string("tree_test/d07.out")),
                                          make_pair(std::string("tree_test/d08.in"),
                                                    std::string("tree_test/d08.out")),
                                          make_pair(std::string("tree_test/d09.in"),
                                                    std::string("tree_test/d09.out")),
                                          make_pair(std::string("tree_test/d10.in"),
                                                    std::string("tree_test/d10.out")),
                                          make_pair(std::string("tree_test/d11.in"),
                                                    std::string("tree_test/d11.out")),
                                          make_pair(std::string("tree_test/d12.in"),
                                                    std::string("tree_test/d12.out")),
                                          make_pair(std::string("tree_test/d13.in"),
                                                    std::string("tree_test/d13.out")),
                                          make_pair(std::string("tree_test/d14.in"),
                                                    std::string("tree_test/d14.out")),
                                          make_pair(std::string("tree_test/d15.in"),
                                                    std::string("tree_test/d15.out")),
                                          make_pair(std::string("tree_test/d16.in"),
                                                    std::string("tree_test/d16.out")),
                                          make_pair(std::string("tree_test/d17.in"),
                                                    std::string("tree_test/d17.out")),
                                          make_pair(std::string("tree_test/d18.in"),
                                                    std::string("tree_test/d18.out")),
                                          make_pair(std::string("tree_test/d19.in"),
                                                    std::string("tree_test/d19.out")),
                                          make_pair(std::string("tree_test/d20.in"),
                                                    std::string("tree_test/d20.out")),
                                          make_pair(std::string("tree_test/e01.in"),
                                                    std::string("tree_test/e01.out")),
                                          make_pair(std::string("tree_test/e02.in"),
                                                    std::string("tree_test/e02.out")),
                                          make_pair(std::string("tree_test/e03.in"),
                                                    std::string("tree_test/e03.out")),
                                          make_pair(std::string("tree_test/e04.in"),
                                                    std::string("tree_test/e04.out")),
                                          make_pair(std::string("tree_test/e05.in"),
                                                    std::string("tree_test/e05.out")),
                                          make_pair(std::string("tree_test/e06.in"),
                                                    std::string("tree_test/e06.out")),
                                          make_pair(std::string("tree_test/e07.in"),
                                                    std::string("tree_test/e07.out")),
                                          make_pair(std::string("tree_test/e08.in"),
                                                    std::string("tree_test/e08.out")),
                                          make_pair(std::string("tree_test/e09.in"),
                                                    std::string("tree_test/e09.out")),
                                          make_pair(std::string("tree_test/e10.in"),
                                                    std::string("tree_test/e10.out")),
                                          make_pair(std::string("tree_test/e11.in"),
                                                    std::string("tree_test/e11.out")),
                                          make_pair(std::string("tree_test/e12.in"),
                                                    std::string("tree_test/e12.out")),
                                          make_pair(std::string("tree_test/e13.in"),
                                                    std::string("tree_test/e13.out")),
                                          make_pair(std::string("tree_test/e14.in"),
                                                    std::string("tree_test/e14.out")),
                                          make_pair(std::string("tree_test/e15.in"),
                                                    std::string("tree_test/e15.out")),
                                          make_pair(std::string("tree_test/e16.in"),
                                                    std::string("tree_test/e16.out")),
                                          make_pair(std::string("tree_test/e17.in"),
                                                    std::string("tree_test/e17.out")),
                                          make_pair(std::string("tree_test/e18.in"),
                                                    std::string("tree_test/e18.out")),
                                          make_pair(std::string("tree_test/e19.in"),
                                                    std::string("tree_test/e19.out")),
                                          make_pair(std::string("tree_test/e20.in"),
                                                    std::string("tree_test/e20.out")),
                                          make_pair(std::string("tree_test/mc11.in"),
                                                    std::string("tree_test/mc11.out")),
                                          make_pair(std::string("tree_test/mc13.in"),
                                                    std::string("tree_test/mc13.out")),
                                          make_pair(std::string("tree_test/mc2.in"),
                                                    std::string("tree_test/mc2.out")),
                                          make_pair(std::string("tree_test/mc3.in"),
                                                    std::string("tree_test/mc3.out")),
                                          make_pair(std::string("tree_test/mc7.in"),
                                                    std::string("tree_test/mc7.out")),
                                          make_pair(std::string("tree_test/mc8.in"),
                                                    std::string("tree_test/mc8.out")),
                                          make_pair(std::string("tree_test/berlin52.in"),
                                                    std::string("tree_test/berlin52.out")),
                                          make_pair(std::string("tree_test/brasil58.in"),
                                                    std::string("tree_test/brasil58.out")),
                                          make_pair(std::string("tree_test/world666.in"),
                                                    std::string("tree_test/world666.out"))
                                          )
                       );



INSTANTIATE_TEST_CASE_P(SteinerForest3, SteinerTest,
                        ::testing::Values(
                                          make_pair(std::string("tree_test/alue2087.in"),
                                                    std::string("tree_test/alue2087.out")),
                                          make_pair(std::string("tree_test/alue2105.in"),
                                                    std::string("tree_test/alue2105.out")),
                                          make_pair(std::string("tree_test/alue3146.in"),
                                                    std::string("tree_test/alue3146.out")),
                                          make_pair(std::string("tree_test/alue5067.in"),
                                                    std::string("tree_test/alue5067.out")),
                                          make_pair(std::string("tree_test/alue5345.in"),
                                                    std::string("tree_test/alue5345.out")),
                                          make_pair(std::string("tree_test/alue5623.in"),
                                                    std::string("tree_test/alue5623.out")),
                                          make_pair(std::string("tree_test/alue5901.in"),
                                                    std::string("tree_test/alue5901.out")),
                                          make_pair(std::string("tree_test/alue6179.in"),
                                                    std::string("tree_test/alue6179.out")),
                                          make_pair(std::string("tree_test/alue6457.in"),
                                                    std::string("tree_test/alue6457.out")),
                                          make_pair(std::string("tree_test/alue6735.in"),
                                                    std::string("tree_test/alue6735.out")),
                                          make_pair(std::string("tree_test/alue6951.in"),
                                                    std::string("tree_test/alue6951.out")),
                                          make_pair(std::string("tree_test/alue7065.in"),
                                                    std::string("tree_test/alue7065.out")),
                                          make_pair(std::string("tree_test/alue7066.in"),
                                                    std::string("tree_test/alue7066.out")),
                                          make_pair(std::string("tree_test/alue7080.in"),
                                                    std::string("tree_test/alue7080.out")),
                                          make_pair(std::string("tree_test/alue7229.in"),
                                                    std::string("tree_test/alue7229.out")),
                                          make_pair(std::string("tree_test/alut0787.in"),
                                                    std::string("tree_test/alut0787.out")),
                                          make_pair(std::string("tree_test/alut0805.in"),
                                                    std::string("tree_test/alut0805.out")),
                                          make_pair(std::string("tree_test/alut1181.in"),
                                                    std::string("tree_test/alut1181.out")),
                                          make_pair(std::string("tree_test/alut2010.in"),
                                                    std::string("tree_test/alut2010.out")),
                                          make_pair(std::string("tree_test/alut2288.in"),
                                                    std::string("tree_test/alut2288.out")),
                                          make_pair(std::string("tree_test/alut2566.in"),
                                                    std::string("tree_test/alut2566.out")),
                                          make_pair(std::string("tree_test/alut2610.in"),
                                                    std::string("tree_test/alut2610.out")),
                                          make_pair(std::string("tree_test/alut2625.in"),
                                                    std::string("tree_test/alut2625.out")),
                                          make_pair(std::string("tree_test/alut2764.in"),
                                                    std::string("tree_test/alut2764.out"))
                                          )
                       );


INSTANTIATE_TEST_CASE_P(SteinerForest4, SteinerTest,
                        ::testing::Values(
                                          make_pair(std::string("tree_test/diw0234.in"),
                                                    std::string("tree_test/diw0234.out")),
                                          make_pair(std::string("tree_test/diw0250.in"),
                                                    std::string("tree_test/diw0250.out")),
                                          make_pair(std::string("tree_test/diw0260.in"),
                                                    std::string("tree_test/diw0260.out")),
                                          make_pair(std::string("tree_test/diw0313.in"),
                                                    std::string("tree_test/diw0313.out")),
                                          make_pair(std::string("tree_test/diw0393.in"),
                                                    std::string("tree_test/diw0393.out")),
                                          make_pair(std::string("tree_test/diw0445.in"),
                                                    std::string("tree_test/diw0445.out")),
                                          make_pair(std::string("tree_test/diw0459.in"),
                                                    std::string("tree_test/diw0459.out")),
                                          make_pair(std::string("tree_test/diw0460.in"),
                                                    std::string("tree_test/diw0460.out")),
                                          make_pair(std::string("tree_test/diw0473.in"),
                                                    std::string("tree_test/diw0473.out")),
                                          make_pair(std::string("tree_test/diw0487.in"),
                                                    std::string("tree_test/diw0487.out")),
                                          make_pair(std::string("tree_test/diw0495.in"),
                                                    std::string("tree_test/diw0495.out")),
                                          make_pair(std::string("tree_test/diw0513.in"),
                                                    std::string("tree_test/diw0513.out")),
                                          make_pair(std::string("tree_test/diw0523.in"),
                                                    std::string("tree_test/diw0523.out")),
                                          make_pair(std::string("tree_test/diw0540.in"),
                                                    std::string("tree_test/diw0540.out")),
                                          make_pair(std::string("tree_test/diw0559.in"),
                                                    std::string("tree_test/diw0559.out")),
                                          make_pair(std::string("tree_test/diw0778.in"),
                                                    std::string("tree_test/diw0778.out")),
                                          make_pair(std::string("tree_test/diw0779.in"),
                                                    std::string("tree_test/diw0779.out")),
                                          make_pair(std::string("tree_test/diw0795.in"),
                                                    std::string("tree_test/diw0795.out")),
                                          make_pair(std::string("tree_test/diw0801.in"),
                                                    std::string("tree_test/diw0801.out")),
                                          make_pair(std::string("tree_test/diw0819.in"),
                                                    std::string("tree_test/diw0819.out")),
                                          make_pair(std::string("tree_test/diw0820.in"),
                                                    std::string("tree_test/diw0820.out"))
                                          )
                       );


INSTANTIATE_TEST_CASE_P(SteinerForest5, SteinerTest,
                        ::testing::Values(
                                          make_pair(std::string("tree_test/dmxa0296.in"),
                                                    std::string("tree_test/dmxa0296.out")),
                                          make_pair(std::string("tree_test/dmxa0368.in"),
                                                    std::string("tree_test/dmxa0368.out")),
                                          make_pair(std::string("tree_test/dmxa0454.in"),
                                                    std::string("tree_test/dmxa0454.out")),
                                          make_pair(std::string("tree_test/dmxa0628.in"),
                                                    std::string("tree_test/dmxa0628.out")),
                                          make_pair(std::string("tree_test/dmxa0734.in"),
                                                    std::string("tree_test/dmxa0734.out")),
                                          make_pair(std::string("tree_test/dmxa0848.in"),
                                                    std::string("tree_test/dmxa0848.out")),
                                          make_pair(std::string("tree_test/dmxa0903.in"),
                                                    std::string("tree_test/dmxa0903.out")),
                                          make_pair(std::string("tree_test/dmxa1010.in"),
                                                    std::string("tree_test/dmxa1010.out")),
                                          make_pair(std::string("tree_test/dmxa1109.in"),
                                                    std::string("tree_test/dmxa1109.out")),
                                          make_pair(std::string("tree_test/dmxa1200.in"),
                                                    std::string("tree_test/dmxa1200.out")),
                                          make_pair(std::string("tree_test/dmxa1304.in"),
                                                    std::string("tree_test/dmxa1304.out")),
                                          make_pair(std::string("tree_test/dmxa1516.in"),
                                                    std::string("tree_test/dmxa1516.out")),
                                          make_pair(std::string("tree_test/dmxa1721.in"),
                                                    std::string("tree_test/dmxa1721.out")),
                                          make_pair(std::string("tree_test/dmxa1801.in"),
                                                    std::string("tree_test/dmxa1801.out")),
                                          make_pair(std::string("tree_test/gap1307.in"),
                                                    std::string("tree_test/gap1307.out")),
                                          make_pair(std::string("tree_test/gap1413.in"),
                                                    std::string("tree_test/gap1413.out")),
                                          make_pair(std::string("tree_test/gap1500.in"),
                                                    std::string("tree_test/gap1500.out")),
                                          make_pair(std::string("tree_test/gap1810.in"),
                                                    std::string("tree_test/gap1810.out")),
                                          make_pair(std::string("tree_test/gap1904.in"),
                                                    std::string("tree_test/gap1904.out")),
                                          make_pair(std::string("tree_test/gap2007.in"),
                                                    std::string("tree_test/gap2007.out")),
                                          make_pair(std::string("tree_test/gap2119.in"),
                                                    std::string("tree_test/gap2119.out")),
                                          make_pair(std::string("tree_test/gap2740.in"),
                                                    std::string("tree_test/gap2740.out")),
                                          make_pair(std::string("tree_test/gap2800.in"),
                                                    std::string("tree_test/gap2800.out")),
                                          make_pair(std::string("tree_test/gap2975.in"),
                                                    std::string("tree_test/gap2975.out")),
                                          make_pair(std::string("tree_test/gap3036.in"),
                                                    std::string("tree_test/gap3036.out")),
                                          make_pair(std::string("tree_test/gap3100.in"),
                                                    std::string("tree_test/gap3100.out")),
                                          make_pair(std::string("tree_test/gap3128.in"),
                                                    std::string("tree_test/gap3128.out"))
                                          )
                       );


INSTANTIATE_TEST_CASE_P(SteinerForest6, SteinerTest,
                        ::testing::Values(
                                            make_pair(std::string("tree_test/msm0580.in"),
                                                      std::string("tree_test/msm0580.out")),
                                            make_pair(std::string("tree_test/msm0654.in"),
                                                      std::string("tree_test/msm0654.out")),
                                            make_pair(std::string("tree_test/msm0709.in"),
                                                      std::string("tree_test/msm0709.out")),
                                            make_pair(std::string("tree_test/msm0920.in"),
                                                      std::string("tree_test/msm0920.out")),
                                            make_pair(std::string("tree_test/msm1008.in"),
                                                      std::string("tree_test/msm1008.out")),
                                            make_pair(std::string("tree_test/msm1234.in"),
                                                      std::string("tree_test/msm1234.out")),
                                            make_pair(std::string("tree_test/msm1477.in"),
                                                      std::string("tree_test/msm1477.out")),
                                            make_pair(std::string("tree_test/msm1707.in"),
                                                      std::string("tree_test/msm1707.out")),
                                            make_pair(std::string("tree_test/msm1844.in"),
                                                      std::string("tree_test/msm1844.out")),
                                            make_pair(std::string("tree_test/msm1931.in"),
                                                      std::string("tree_test/msm1931.out")),
                                            make_pair(std::string("tree_test/msm2000.in"),
                                                      std::string("tree_test/msm2000.out")),
                                            make_pair(std::string("tree_test/msm2152.in"),
                                                      std::string("tree_test/msm2152.out")),
                                            make_pair(std::string("tree_test/msm2326.in"),
                                                      std::string("tree_test/msm2326.out")),
                                            make_pair(std::string("tree_test/msm2492.in"),
                                                      std::string("tree_test/msm2492.out")),
                                            make_pair(std::string("tree_test/msm2525.in"),
                                                      std::string("tree_test/msm2525.out")),
                                            make_pair(std::string("tree_test/msm2601.in"),
                                                      std::string("tree_test/msm2601.out")),
                                            make_pair(std::string("tree_test/msm2705.in"),
                                                      std::string("tree_test/msm2705.out")),
                                            make_pair(std::string("tree_test/msm2802.in"),
                                                      std::string("tree_test/msm2802.out")),
                                            make_pair(std::string("tree_test/msm2846.in"),
                                                      std::string("tree_test/msm2846.out")),
                                            make_pair(std::string("tree_test/msm3277.in"),
                                                      std::string("tree_test/msm3277.out")),
                                            make_pair(std::string("tree_test/msm3676.in"),
                                                      std::string("tree_test/msm3676.out")),
                                            make_pair(std::string("tree_test/msm3727.in"),
                                                      std::string("tree_test/msm3727.out")),
                                            make_pair(std::string("tree_test/msm3829.in"),
                                                      std::string("tree_test/msm3829.out")),
                                            make_pair(std::string("tree_test/msm4038.in"),
                                                      std::string("tree_test/msm4038.out")),
                                            make_pair(std::string("tree_test/msm4114.in"),
                                                      std::string("tree_test/msm4114.out")),
                                            make_pair(std::string("tree_test/msm4190.in"),
                                                      std::string("tree_test/msm4190.out")),
                                            make_pair(std::string("tree_test/msm4224.in"),
                                                      std::string("tree_test/msm4224.out")),
                                            make_pair(std::string("tree_test/msm4312.in"),
                                                      std::string("tree_test/msm4312.out")),
                                            make_pair(std::string("tree_test/msm4414.in"),
                                                      std::string("tree_test/msm4414.out")),
                                            make_pair(std::string("tree_test/msm4515.in"),
                                                      std::string("tree_test/msm4515.out"))
                                         )
                       );


INSTANTIATE_TEST_CASE_P(SteinerForest7, SteinerTest,
                        ::testing::Values(
                                            make_pair(std::string("tree_test/taq0014.in"),
                                                      std::string("tree_test/taq0014.out")),
                                            make_pair(std::string("tree_test/taq0023.in"),
                                                      std::string("tree_test/taq0023.out")),
                                            make_pair(std::string("tree_test/taq0365.in"),
                                                      std::string("tree_test/taq0365.out")),
                                            make_pair(std::string("tree_test/taq0377.in"),
                                                      std::string("tree_test/taq0377.out")),
                                            make_pair(std::string("tree_test/taq0431.in"),
                                                      std::string("tree_test/taq0431.out")),
                                            make_pair(std::string("tree_test/taq0631.in"),
                                                      std::string("tree_test/taq0631.out")),
                                            make_pair(std::string("tree_test/taq0739.in"),
                                                      std::string("tree_test/taq0739.out")),
                                            make_pair(std::string("tree_test/taq0741.in"),
                                                      std::string("tree_test/taq0741.out")),
                                            make_pair(std::string("tree_test/taq0751.in"),
                                                      std::string("tree_test/taq0751.out")),
                                            make_pair(std::string("tree_test/taq0891.in"),
                                                      std::string("tree_test/taq0891.out")),
                                            make_pair(std::string("tree_test/taq0903.in"),
                                                      std::string("tree_test/taq0903.out")),
                                            make_pair(std::string("tree_test/taq0910.in"),
                                                      std::string("tree_test/taq0910.out")),
                                            make_pair(std::string("tree_test/taq0920.in"),
                                                      std::string("tree_test/taq0920.out")),
                                            make_pair(std::string("tree_test/taq0978.in"),
                                                      std::string("tree_test/taq0978.out")),
                                            make_pair(std::string("tree_test/es10fst01.in"),
                                                      std::string("tree_test/es10fst01.out")),
                                            make_pair(std::string("tree_test/es10fst02.in"),
                                                      std::string("tree_test/es10fst02.out")),
                                            make_pair(std::string("tree_test/es10fst03.in"),
                                                      std::string("tree_test/es10fst03.out")),
                                            make_pair(std::string("tree_test/es10fst04.in"),
                                                      std::string("tree_test/es10fst04.out")),
                                            make_pair(std::string("tree_test/es10fst05.in"),
                                                      std::string("tree_test/es10fst05.out")),
                                            make_pair(std::string("tree_test/es10fst06.in"),
                                                      std::string("tree_test/es10fst06.out")),
                                            make_pair(std::string("tree_test/es10fst07.in"),
                                                      std::string("tree_test/es10fst07.out")),
                                            make_pair(std::string("tree_test/es10fst08.in"),
                                                      std::string("tree_test/es10fst08.out")),
                                            make_pair(std::string("tree_test/es10fst09.in"),
                                                      std::string("tree_test/es10fst09.out")),
                                            make_pair(std::string("tree_test/es10fst10.in"),
                                                      std::string("tree_test/es10fst10.out")),
                                            make_pair(std::string("tree_test/es10fst11.in"),
                                                      std::string("tree_test/es10fst11.out")),
                                            make_pair(std::string("tree_test/es10fst12.in"),
                                                      std::string("tree_test/es10fst12.out")),
                                            make_pair(std::string("tree_test/es10fst13.in"),
                                                      std::string("tree_test/es10fst13.out")),
                                            make_pair(std::string("tree_test/es10fst14.in"),
                                                      std::string("tree_test/es10fst14.out")),
                                            make_pair(std::string("tree_test/es10fst15.in"),
                                                      std::string("tree_test/es10fst15.out"))
                                         )
                       );


INSTANTIATE_TEST_CASE_P(SteinerForest8, SteinerTest,
                        ::testing::Values(
make_pair(std::string("tree_test/es20fst01.in"),
          std::string("tree_test/es20fst01.out")),
make_pair(std::string("tree_test/es20fst02.in"),
          std::string("tree_test/es20fst02.out")),
make_pair(std::string("tree_test/es20fst03.in"),
          std::string("tree_test/es20fst03.out")),
make_pair(std::string("tree_test/es20fst04.in"),
          std::string("tree_test/es20fst04.out")),
make_pair(std::string("tree_test/es20fst05.in"),
          std::string("tree_test/es20fst05.out")),
make_pair(std::string("tree_test/es20fst06.in"),
          std::string("tree_test/es20fst06.out")),
make_pair(std::string("tree_test/es20fst07.in"),
          std::string("tree_test/es20fst07.out")),
make_pair(std::string("tree_test/es20fst08.in"),
          std::string("tree_test/es20fst08.out")),
make_pair(std::string("tree_test/es20fst09.in"),
          std::string("tree_test/es20fst09.out")),
make_pair(std::string("tree_test/es20fst10.in"),
          std::string("tree_test/es20fst10.out")),
make_pair(std::string("tree_test/es20fst11.in"),
          std::string("tree_test/es20fst11.out")),
make_pair(std::string("tree_test/es20fst12.in"),
          std::string("tree_test/es20fst12.out")),
make_pair(std::string("tree_test/es20fst13.in"),
          std::string("tree_test/es20fst13.out")),
make_pair(std::string("tree_test/es20fst14.in"),
          std::string("tree_test/es20fst14.out")),
make_pair(std::string("tree_test/es20fst15.in"),
          std::string("tree_test/es20fst15.out")),
make_pair(std::string("tree_test/es30fst01.in"),
          std::string("tree_test/es30fst01.out")),
make_pair(std::string("tree_test/es30fst02.in"),
          std::string("tree_test/es30fst02.out")),
make_pair(std::string("tree_test/es30fst03.in"),
          std::string("tree_test/es30fst03.out")),
make_pair(std::string("tree_test/es30fst04.in"),
          std::string("tree_test/es30fst04.out")),
make_pair(std::string("tree_test/es30fst05.in"),
          std::string("tree_test/es30fst05.out")),
make_pair(std::string("tree_test/es30fst06.in"),
          std::string("tree_test/es30fst06.out")),
make_pair(std::string("tree_test/es30fst07.in"),
          std::string("tree_test/es30fst07.out")),
make_pair(std::string("tree_test/es30fst08.in"),
          std::string("tree_test/es30fst08.out")),
make_pair(std::string("tree_test/es30fst09.in"),
          std::string("tree_test/es30fst09.out")),
make_pair(std::string("tree_test/es30fst10.in"),
          std::string("tree_test/es30fst10.out")),
make_pair(std::string("tree_test/es30fst11.in"),
          std::string("tree_test/es30fst11.out")),
make_pair(std::string("tree_test/es30fst12.in"),
          std::string("tree_test/es30fst12.out")),
make_pair(std::string("tree_test/es30fst13.in"),
          std::string("tree_test/es30fst13.out")),
make_pair(std::string("tree_test/es30fst14.in"),
          std::string("tree_test/es30fst14.out")),
make_pair(std::string("tree_test/es30fst15.in"),
          std::string("tree_test/es30fst15.out")),
make_pair(std::string("tree_test/es40fst01.in"),
          std::string("tree_test/es40fst01.out")),
make_pair(std::string("tree_test/es40fst02.in"),
          std::string("tree_test/es40fst02.out")),
make_pair(std::string("tree_test/es40fst03.in"),
          std::string("tree_test/es40fst03.out")),
make_pair(std::string("tree_test/es40fst04.in"),
          std::string("tree_test/es40fst04.out")),
make_pair(std::string("tree_test/es40fst05.in"),
          std::string("tree_test/es40fst05.out")),
make_pair(std::string("tree_test/es40fst06.in"),
          std::string("tree_test/es40fst06.out")),
make_pair(std::string("tree_test/es40fst07.in"),
          std::string("tree_test/es40fst07.out")),
make_pair(std::string("tree_test/es40fst08.in"),
          std::string("tree_test/es40fst08.out")),
make_pair(std::string("tree_test/es40fst09.in"),
          std::string("tree_test/es40fst09.out")),
make_pair(std::string("tree_test/es40fst10.in"),
          std::string("tree_test/es40fst10.out")),
make_pair(std::string("tree_test/es40fst11.in"),
          std::string("tree_test/es40fst11.out")),
make_pair(std::string("tree_test/es40fst12.in"),
          std::string("tree_test/es40fst12.out")),
make_pair(std::string("tree_test/es40fst13.in"),
          std::string("tree_test/es40fst13.out")),
make_pair(std::string("tree_test/es40fst14.in"),
          std::string("tree_test/es40fst14.out")),
make_pair(std::string("tree_test/es40fst15.in"),
          std::string("tree_test/es40fst15.out"))
                                         )
                       );



INSTANTIATE_TEST_CASE_P(SteinerForest9, SteinerTest,
                        ::testing::Values(
make_pair(std::string("tree_test/es50fst01.in"),
          std::string("tree_test/es50fst01.out")),
make_pair(std::string("tree_test/es50fst02.in"),
          std::string("tree_test/es50fst02.out")),
make_pair(std::string("tree_test/es50fst03.in"),
          std::string("tree_test/es50fst03.out")),
make_pair(std::string("tree_test/es50fst04.in"),
          std::string("tree_test/es50fst04.out")),
make_pair(std::string("tree_test/es50fst05.in"),
          std::string("tree_test/es50fst05.out")),
make_pair(std::string("tree_test/es50fst06.in"),
          std::string("tree_test/es50fst06.out")),
make_pair(std::string("tree_test/es50fst07.in"),
          std::string("tree_test/es50fst07.out")),
make_pair(std::string("tree_test/es50fst08.in"),
          std::string("tree_test/es50fst08.out")),
make_pair(std::string("tree_test/es50fst09.in"),
          std::string("tree_test/es50fst09.out")),
make_pair(std::string("tree_test/es50fst10.in"),
          std::string("tree_test/es50fst10.out")),
make_pair(std::string("tree_test/es50fst11.in"),
          std::string("tree_test/es50fst11.out")),
make_pair(std::string("tree_test/es50fst12.in"),
          std::string("tree_test/es50fst12.out")),
make_pair(std::string("tree_test/es50fst13.in"),
          std::string("tree_test/es50fst13.out")),
make_pair(std::string("tree_test/es50fst14.in"),
          std::string("tree_test/es50fst14.out")),
make_pair(std::string("tree_test/es50fst15.in"),
          std::string("tree_test/es50fst15.out")),
make_pair(std::string("tree_test/es60fst01.in"),
          std::string("tree_test/es60fst01.out")),
make_pair(std::string("tree_test/es60fst02.in"),
          std::string("tree_test/es60fst02.out")),
make_pair(std::string("tree_test/es60fst03.in"),
          std::string("tree_test/es60fst03.out")),
make_pair(std::string("tree_test/es60fst04.in"),
          std::string("tree_test/es60fst04.out")),
make_pair(std::string("tree_test/es60fst05.in"),
          std::string("tree_test/es60fst05.out")),
make_pair(std::string("tree_test/es60fst06.in"),
          std::string("tree_test/es60fst06.out")),
make_pair(std::string("tree_test/es60fst07.in"),
          std::string("tree_test/es60fst07.out")),
make_pair(std::string("tree_test/es60fst08.in"),
          std::string("tree_test/es60fst08.out")),
make_pair(std::string("tree_test/es60fst09.in"),
          std::string("tree_test/es60fst09.out")),
make_pair(std::string("tree_test/es60fst10.in"),
          std::string("tree_test/es60fst10.out")),
make_pair(std::string("tree_test/es60fst11.in"),
          std::string("tree_test/es60fst11.out")),
make_pair(std::string("tree_test/es60fst12.in"),
          std::string("tree_test/es60fst12.out")),
make_pair(std::string("tree_test/es60fst13.in"),
          std::string("tree_test/es60fst13.out")),
make_pair(std::string("tree_test/es60fst14.in"),
          std::string("tree_test/es60fst14.out")),
make_pair(std::string("tree_test/es60fst15.in"),
          std::string("tree_test/es60fst15.out")),
make_pair(std::string("tree_test/es70fst01.in"),
          std::string("tree_test/es70fst01.out")),
make_pair(std::string("tree_test/es70fst02.in"),
          std::string("tree_test/es70fst02.out")),
make_pair(std::string("tree_test/es70fst03.in"),
          std::string("tree_test/es70fst03.out")),
make_pair(std::string("tree_test/es70fst04.in"),
          std::string("tree_test/es70fst04.out")),
make_pair(std::string("tree_test/es70fst05.in"),
          std::string("tree_test/es70fst05.out")),
make_pair(std::string("tree_test/es70fst06.in"),
          std::string("tree_test/es70fst06.out")),
make_pair(std::string("tree_test/es70fst07.in"),
          std::string("tree_test/es70fst07.out")),
make_pair(std::string("tree_test/es70fst08.in"),
          std::string("tree_test/es70fst08.out")),
make_pair(std::string("tree_test/es70fst09.in"),
          std::string("tree_test/es70fst09.out")),
make_pair(std::string("tree_test/es70fst10.in"),
          std::string("tree_test/es70fst10.out")),
make_pair(std::string("tree_test/es70fst11.in"),
          std::string("tree_test/es70fst11.out")),
make_pair(std::string("tree_test/es70fst12.in"),
          std::string("tree_test/es70fst12.out")),
make_pair(std::string("tree_test/es70fst13.in"),
          std::string("tree_test/es70fst13.out")),
make_pair(std::string("tree_test/es70fst14.in"),
          std::string("tree_test/es70fst14.out")),
make_pair(std::string("tree_test/es70fst15.in"),
          std::string("tree_test/es70fst15.out"))
                                         )
                       );


INSTANTIATE_TEST_CASE_P(SteinerForest10, SteinerTest,
                        ::testing::Values(
make_pair(std::string("tree_test/es80fst01.in"),
          std::string("tree_test/es80fst01.out")),
make_pair(std::string("tree_test/es80fst02.in"),
          std::string("tree_test/es80fst02.out")),
make_pair(std::string("tree_test/es80fst03.in"),
          std::string("tree_test/es80fst03.out")),
make_pair(std::string("tree_test/es80fst04.in"),
          std::string("tree_test/es80fst04.out")),
make_pair(std::string("tree_test/es80fst05.in"),
          std::string("tree_test/es80fst05.out")),
make_pair(std::string("tree_test/es80fst06.in"),
          std::string("tree_test/es80fst06.out")),
make_pair(std::string("tree_test/es80fst07.in"),
          std::string("tree_test/es80fst07.out")),
make_pair(std::string("tree_test/es80fst08.in"),
          std::string("tree_test/es80fst08.out")),
make_pair(std::string("tree_test/es80fst09.in"),
          std::string("tree_test/es80fst09.out")),
make_pair(std::string("tree_test/es80fst10.in"),
          std::string("tree_test/es80fst10.out")),
make_pair(std::string("tree_test/es80fst11.in"),
          std::string("tree_test/es80fst11.out")),
make_pair(std::string("tree_test/es80fst12.in"),
          std::string("tree_test/es80fst12.out")),
make_pair(std::string("tree_test/es80fst13.in"),
          std::string("tree_test/es80fst13.out")),
make_pair(std::string("tree_test/es80fst14.in"),
          std::string("tree_test/es80fst14.out")),
make_pair(std::string("tree_test/es80fst15.in"),
          std::string("tree_test/es80fst15.out")),
make_pair(std::string("tree_test/es90fst01.in"),
          std::string("tree_test/es90fst01.out")),
make_pair(std::string("tree_test/es90fst02.in"),
          std::string("tree_test/es90fst02.out")),
make_pair(std::string("tree_test/es90fst03.in"),
          std::string("tree_test/es90fst03.out")),
make_pair(std::string("tree_test/es90fst04.in"),
          std::string("tree_test/es90fst04.out")),
make_pair(std::string("tree_test/es90fst05.in"),
          std::string("tree_test/es90fst05.out")),
make_pair(std::string("tree_test/es90fst06.in"),
          std::string("tree_test/es90fst06.out")),
make_pair(std::string("tree_test/es90fst07.in"),
          std::string("tree_test/es90fst07.out")),
make_pair(std::string("tree_test/es90fst08.in"),
          std::string("tree_test/es90fst08.out")),
make_pair(std::string("tree_test/es90fst09.in"),
          std::string("tree_test/es90fst09.out")),
make_pair(std::string("tree_test/es90fst10.in"),
          std::string("tree_test/es90fst10.out")),
make_pair(std::string("tree_test/es90fst11.in"),
          std::string("tree_test/es90fst11.out")),
make_pair(std::string("tree_test/es90fst12.in"),
          std::string("tree_test/es90fst12.out")),
make_pair(std::string("tree_test/es90fst13.in"),
          std::string("tree_test/es90fst13.out")),
make_pair(std::string("tree_test/es90fst14.in"),
          std::string("tree_test/es90fst14.out")),
make_pair(std::string("tree_test/es90fst15.in"),
          std::string("tree_test/es90fst15.out")),
make_pair(std::string("tree_test/es100fst01.in"),
          std::string("tree_test/es100fst01.out")),
make_pair(std::string("tree_test/es100fst02.in"),
          std::string("tree_test/es100fst02.out")),
make_pair(std::string("tree_test/es100fst03.in"),
          std::string("tree_test/es100fst03.out")),
make_pair(std::string("tree_test/es100fst04.in"),
          std::string("tree_test/es100fst04.out")),
make_pair(std::string("tree_test/es100fst05.in"),
          std::string("tree_test/es100fst05.out")),
make_pair(std::string("tree_test/es100fst06.in"),
          std::string("tree_test/es100fst06.out")),
make_pair(std::string("tree_test/es100fst07.in"),
          std::string("tree_test/es100fst07.out")),
make_pair(std::string("tree_test/es100fst08.in"),
          std::string("tree_test/es100fst08.out")),
make_pair(std::string("tree_test/es100fst09.in"),
          std::string("tree_test/es100fst09.out")),
make_pair(std::string("tree_test/es100fst10.in"),
          std::string("tree_test/es100fst10.out")),
make_pair(std::string("tree_test/es100fst11.in"),
          std::string("tree_test/es100fst11.out")),
make_pair(std::string("tree_test/es100fst12.in"),
          std::string("tree_test/es100fst12.out")),
make_pair(std::string("tree_test/es100fst13.in"),
          std::string("tree_test/es100fst13.out")),
make_pair(std::string("tree_test/es100fst14.in"),
          std::string("tree_test/es100fst14.out")),
make_pair(std::string("tree_test/es100fst15.in"),
          std::string("tree_test/es100fst15.out"))
                                         )
                       );


INSTANTIATE_TEST_CASE_P(SteinerForest11, SteinerTest,
                        ::testing::Values(
make_pair(std::string("tree_test/es250fst01.in"),
          std::string("tree_test/es250fst01.out")),
make_pair(std::string("tree_test/es250fst02.in"),
          std::string("tree_test/es250fst02.out")),
make_pair(std::string("tree_test/es250fst03.in"),
          std::string("tree_test/es250fst03.out")),
make_pair(std::string("tree_test/es250fst04.in"),
          std::string("tree_test/es250fst04.out")),
make_pair(std::string("tree_test/es250fst05.in"),
          std::string("tree_test/es250fst05.out")),
make_pair(std::string("tree_test/es250fst06.in"),
          std::string("tree_test/es250fst06.out")),
make_pair(std::string("tree_test/es250fst07.in"),
          std::string("tree_test/es250fst07.out")),
make_pair(std::string("tree_test/es250fst08.in"),
          std::string("tree_test/es250fst08.out")),
make_pair(std::string("tree_test/es250fst09.in"),
          std::string("tree_test/es250fst09.out")),
make_pair(std::string("tree_test/es250fst10.in"),
          std::string("tree_test/es250fst10.out")),
make_pair(std::string("tree_test/es250fst11.in"),
          std::string("tree_test/es250fst11.out")),
make_pair(std::string("tree_test/es250fst12.in"),
          std::string("tree_test/es250fst12.out")),
make_pair(std::string("tree_test/es250fst13.in"),
          std::string("tree_test/es250fst13.out")),
make_pair(std::string("tree_test/es250fst14.in"),
          std::string("tree_test/es250fst14.out")),
make_pair(std::string("tree_test/es250fst15.in"),
          std::string("tree_test/es250fst15.out")),
make_pair(std::string("tree_test/es500fst01.in"),
          std::string("tree_test/es500fst01.out")),
make_pair(std::string("tree_test/es500fst02.in"),
          std::string("tree_test/es500fst02.out")),
make_pair(std::string("tree_test/es500fst03.in"),
          std::string("tree_test/es500fst03.out")),
make_pair(std::string("tree_test/es500fst04.in"),
          std::string("tree_test/es500fst04.out")),
make_pair(std::string("tree_test/es500fst05.in"),
          std::string("tree_test/es500fst05.out")),
make_pair(std::string("tree_test/es500fst06.in"),
          std::string("tree_test/es500fst06.out")),
make_pair(std::string("tree_test/es500fst07.in"),
          std::string("tree_test/es500fst07.out")),
make_pair(std::string("tree_test/es500fst08.in"),
          std::string("tree_test/es500fst08.out")),
make_pair(std::string("tree_test/es500fst09.in"),
          std::string("tree_test/es500fst09.out")),
make_pair(std::string("tree_test/es500fst10.in"),
          std::string("tree_test/es500fst10.out")),
make_pair(std::string("tree_test/es500fst11.in"),
          std::string("tree_test/es500fst11.out")),
make_pair(std::string("tree_test/es500fst12.in"),
          std::string("tree_test/es500fst12.out")),
make_pair(std::string("tree_test/es500fst13.in"),
          std::string("tree_test/es500fst13.out")),
make_pair(std::string("tree_test/es500fst14.in"),
          std::string("tree_test/es500fst14.out")),
make_pair(std::string("tree_test/es500fst15.in"),
          std::string("tree_test/es500fst15.out")),
make_pair(std::string("tree_test/es1000fst01.in"),
          std::string("tree_test/es1000fst01.out")),
make_pair(std::string("tree_test/es1000fst02.in"),
          std::string("tree_test/es1000fst02.out")),
make_pair(std::string("tree_test/es1000fst03.in"),
          std::string("tree_test/es1000fst03.out")),
make_pair(std::string("tree_test/es1000fst04.in"),
          std::string("tree_test/es1000fst04.out")),
make_pair(std::string("tree_test/es1000fst05.in"),
          std::string("tree_test/es1000fst05.out")),
make_pair(std::string("tree_test/es1000fst06.in"),
          std::string("tree_test/es1000fst06.out")),
make_pair(std::string("tree_test/es1000fst07.in"),
          std::string("tree_test/es1000fst07.out")),
make_pair(std::string("tree_test/es1000fst08.in"),
          std::string("tree_test/es1000fst08.out")),
make_pair(std::string("tree_test/es1000fst09.in"),
          std::string("tree_test/es1000fst09.out")),
make_pair(std::string("tree_test/es1000fst10.in"),
          std::string("tree_test/es1000fst10.out")),
make_pair(std::string("tree_test/es1000fst11.in"),
          std::string("tree_test/es1000fst11.out")),
make_pair(std::string("tree_test/es1000fst12.in"),
          std::string("tree_test/es1000fst12.out")),
make_pair(std::string("tree_test/es1000fst13.in"),
          std::string("tree_test/es1000fst13.out")),
make_pair(std::string("tree_test/es1000fst14.in"),
          std::string("tree_test/es1000fst14.out")),
make_pair(std::string("tree_test/es1000fst15.in"),
          std::string("tree_test/es1000fst15.out"))
                                         )
                       );


